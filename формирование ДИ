main();
function main(){
var ogroups = ArisData.getSelectedGroups();
var g_nLoc = Context.getSelectedLanguage();
var outfilereport = Context.createOutputObject(Context.getSelectedFormat(), Context.getSelectedFile());
    if (ogroups.length == 1) {
  var epcModelList = ogroups[0].ModelList(true, [Constants.MT_EEPC]);
 var temppos_type = []; 
 for (var i=0;i<epcModelList.length;i++){ //со всех моделей собрали тип лица
 temppos_type.push(epcModelList[i].ObjOccListBySymbol([Constants.ST_EMPL_TYPE]));
 }
 list_alltypeFaceOccs=[]; //Occ всех объектов "ТИП ЛИЦА" в выбранной группе!!!
     for (var i=0;i<temppos_type.length;i++){
       list_alltypeFaceOccs=list_alltypeFaceOccs.concat(temppos_type[i]);
     }
  var list_alltypeFaceOccsIDs=[];
      for (var i=0;i<list_alltypeFaceOccs.length;i++){
        list_alltypeFaceOccsIDs[i]=list_alltypeFaceOccs[i].ObjectID();
      }
//формируем спискок должностей для всего БП 
 var DolgnList = []; //список должностей для выбранной группы. формируются только из ObjDef
 for (var i=0;i<list_alltypeFaceOccs.length;i++){ 
    var temp_posobjdef = list_alltypeFaceOccs[i].ObjDef();
    var cxnlist = temp_posobjdef.CxnListFilter(Constants.EDGES_IN,Constants.CT_EXEC_5);
    for (var j=0;j<cxnlist.length;j++){
      //  Dialogs.MsgBox(cxnlist[i].SourceObjDef().Name(g_nLoc));
    DolgnList.push(cxnlist[j].SourceObjDef() );
  }
 } // конец для for (var i=0;i<list_alltypeFaceOccs.length;i++){ 
//     var outputArray=[["тип лица","должность","функция"]];
 DolgnList = ArisData.Unique(DolgnList); //сформированный список должностей без повторов. может и не пригодится... 
var di_element_class = init_di_element_class(); //инициировали класс в обшем
var di_elements = init_di_element_class[];
outputArray=[["","",""]];
for (var i=0;i<list_alltypeFaceOccs.length;i++){ //тип лица
    var temptypeface = list_alltypeFaceOccs[i];//.ObjDef().Name();
    var tempfunc = list_alltypeFaceOccs[i].getConnectedObjOccs ( [Constants.ST_SYS_FUNC_ACT,Constants.ST_SYS_FUNC_TRG,Constants.ST_FUNC,Constants.ST_FUNC_ACT,Constants.ST_FUNC_TRG,], Constants.EDGES_OUT );
    for (var j=0;j<tempfunc.length;j++){ //функции
        for( var k=0; k<temptypeface.ObjDef().CxnListFilter(Constants.EDGES_IN,Constants.CT_EXEC_5).length;k++){  //Роли
          outputArray.push([list_alltypeFaceOccs[i].ObjDef().Name(g_nLoc),temptypeface.ObjDef().CxnListFilter(Constants.EDGES_IN,Constants.CT_EXEC_5)[k].SourceObjDef().Name(g_nLoc),tempfunc[j].ObjDef().Name(g_nLoc) ])
        }
    }
}
   outfilereport.BeginTable(100,Constants.C_BLACK,Constants.C_WHITE,Constants.FMT_LEFT | Constants.FMT_ITALIC,0); 
   outfilereport.TableRow(); 
   outfilereport.TableCell(" тип лица",33,"Arial",12,Constants.C_BLACK,Constants.C_WHITE,0,Constants.FMT_CENTER,0); 
   outfilereport.TableCell(" должность",33,"Arial",12,Constants.C_BLACK,Constants.C_WHITE,0,Constants.FMT_CENTER,0); 
   outfilereport.TableCell(" функция",34,"Arial",12,Constants.C_BLACK,Constants.C_WHITE,0,Constants.FMT_CENTER,0); 
        for (var i=0;i<outputArray.length;i++){
           outfilereport.TableRow(); 
           outfilereport.TableCell(outputArray[i][0],33,"Arial",12,Constants.C_BLACK,Constants.C_WHITE,0,Constants.FMT_CENTER,0); 
           outfilereport.TableCell(outputArray[i][1],33,"Arial",12,Constants.C_BLACK,Constants.C_WHITE,0,Constants.FMT_CENTER,0); 
           outfilereport.TableCell(outputArray[i][2],34,"Arial",12,Constants.C_BLACK,Constants.C_WHITE,0,Constants.FMT_CENTER,0); 
        }
  outfilereport.EndTable("",100, "Arial",10,Constants.C_BLACK,Constants.C_BLACK,0,Constants.FMT_LEFT | Constants.FMT_ITALIC,0);   
  outfilereport.WriteReport(Context.getSelectedPath(), Context.getSelectedFile());
        }//
        else {
            Context.setScriptError(Constants.ERR_CANCEL);
        }
}
function init_di_element_class(){
   var di_element_class = function(type_face,func,position ){
           this.objOcc = type_face;
           this.func = func; 
           this.position = position;
           this.subprocess = type_face.Model();
   }
   //proto is short for prototype
   var proto = di_element_class.prototype;
   proto.get_Funcss = function(){};
   proto.get_Group = function(){};
   
   
   return di_element_class;
}
